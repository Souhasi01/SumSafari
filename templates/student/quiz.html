{% extends "base.html" %}
{% block title %}Quiz â€” SumSafari{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="card shadow-lg p-4 rounded-4" style="background: var(--soft-cream); border:none;">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3 style="color: var(--jungle-green);">Quiz</h3>
      <div>
        <strong>Time left:</strong>
        <span id="timer">00:00</span>
      </div>
    </div>

    <form id="quiz-form" action="{{ url_for('quiz.submit_quiz', quiz_id=quiz.quiz_id) }}" method="POST">
      {% for q in questions %}
      <div class="mb-4">
        <p><strong>Q{{ loop.index }}.</strong> {{ q.question }}</p>
        <input type="text" name="answer_{{ loop.index }}" class="form-control">
      </div>
      {% endfor %}

      <div class="d-flex justify-content-between align-items-center mt-3">
        <a href="{{ url_for('student.topics') }}" class="btn btn-secondary rounded-pill">Back</a>
        <button type="submit" class="btn btn-primary rounded-pill">Submit Quiz</button>
      </div>
    </form>
  </div>
</div>

{% block scripts %}
<script>
(function(){
  // total time in seconds (example 10 minutes) - you can make dynamic
  const totalSeconds = 10 * 60;
  let remaining = totalSeconds;
  const timerEl = document.getElementById('timer');

  function formatTime(s){
    const m = Math.floor(s/60).toString().padStart(2,'0');
    const sec = Math.floor(s%60).toString().padStart(2,'0');
    return `${m}:${sec}`;
  }

  timerEl.textContent = formatTime(remaining);
  const interval = setInterval(() => {
    remaining -= 1;
    timerEl.textContent = formatTime(remaining);
    if (remaining <= 0) {
      clearInterval(interval);
      // auto-submit the form
      document.getElementById('quiz-form').submit();
    }
  }, 1000);
})();
</script>
{% endblock %}
{% endblock %}
